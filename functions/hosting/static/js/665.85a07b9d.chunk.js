"use strict";(self.webpackChunkreservaciones_admin=self.webpackChunkreservaciones_admin||[]).push([[665],{1072:(e,s,a)=>{a.d(s,{A:()=>x});var t=a(2555),r=a(45),l=a(8139),i=a.n(l),c=a(5043),n=a(7852),d=a(579);const o=["bsPrefix","className","as"],m=c.forwardRef((e,s)=>{let{bsPrefix:a,className:l,as:c="div"}=e,m=(0,r.A)(e,o);const x=(0,n.oU)(a,"row"),f=(0,n.gy)(),h=(0,n.Jm)(),b="".concat(x,"-cols"),N=[];return f.forEach(e=>{const s=m[e];let a;delete m[e],null!=s&&"object"===typeof s?({cols:a}=s):a=s;const t=e!==h?"-".concat(e):"";null!=a&&N.push("".concat(b).concat(t,"-").concat(a))}),(0,d.jsx)(c,(0,t.A)((0,t.A)({ref:s},m),{},{className:i()(l,x,...N)}))});m.displayName="Row";const x=m},3829:(e,s,a)=>{a.d(s,{GF:()=>l,Sk:()=>r,Yq:()=>t});const t=e=>{if(!e)return"";let s;return s=e&&"object"===typeof e&&"seconds"in e?new Date(1e3*e.seconds):new Date(e),isNaN(s.getTime())?"Invalid Date":s.toLocaleString("default",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},r=e=>{const s=["linear-gradient(135deg, #f6d365 0%, #fda085 100%)","linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%)","linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)","linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%)"];let a=0;for(let t=0;t<e.length;t++)a=e.charCodeAt(t)+((a<<5)-a);return s[Math.abs(a)%s.length]},l=(e,s,a)=>{if(!e||0===e.length)return void alert("No reservations to export");const r=s.fields.map(e=>e.label);r.push("Promoter","Created At");const l=e.map(e=>{const r=s.fields.map(s=>{const a=e.formData[s.label]||"";return'"'.concat(String(a).replace(/"/g,'""'),'"')}),l=a[e.promoterId]||(e.promoterId?"Unknown":"Direct");r.push('"'.concat(l,'"'));const i=t(e.createdAt);return r.push('"'.concat(i,'"')),r.join(",")}),i=[r.join(","),...l].join("\n"),c=new Blob([i],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),d=URL.createObjectURL(c);n.setAttribute("href",d),n.setAttribute("download","".concat(s.title.replace(/[^a-z0-9]/gi,"_"),"_reservations_").concat((new Date).toISOString().split("T")[0],".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},4063:(e,s,a)=>{a.d(s,{A:()=>x});var t=a(2555),r=a(45),l=a(8139),i=a.n(l),c=a(5043),n=a(7852),d=a(579);const o=["bsPrefix","bg","pill","text","className","as"],m=c.forwardRef((e,s)=>{let{bsPrefix:a,bg:l="primary",pill:c=!1,text:m,className:x,as:f="span"}=e,h=(0,r.A)(e,o);const b=(0,n.oU)(a,"badge");return(0,d.jsx)(f,(0,t.A)((0,t.A)({ref:s},h),{},{className:i()(x,b,c&&"rounded-pill",m&&"text-".concat(m),l&&"bg-".concat(l))}))});m.displayName="Badge";const x=m},4488:(e,s,a)=>{a.d(s,{A:()=>n});var t=a(2555),r=a(5043),l=a(8139),i=a.n(l),c=a(579);const n=e=>r.forwardRef((s,a)=>(0,c.jsx)("div",(0,t.A)((0,t.A)({},s),{},{ref:a,className:i()(s.className,e)})))},8258:(e,s,a)=>{a.d(s,{A:()=>q});var t=a(2555),r=a(45),l=a(8139),i=a.n(l),c=a(5043),n=a(7852),d=a(579);const o=["className","bsPrefix","as"],m=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c="div"}=e,m=(0,r.A)(e,o);return l=(0,n.oU)(l,"card-body"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},m))});m.displayName="CardBody";const x=m,f=["className","bsPrefix","as"],h=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c="div"}=e,o=(0,r.A)(e,f);return l=(0,n.oU)(l,"card-footer"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});h.displayName="CardFooter";const b=h,N=c.createContext(null);N.displayName="CardHeaderContext";const u=N,g=["bsPrefix","className","as"],p=c.forwardRef((e,s)=>{let{bsPrefix:a,className:l,as:o="div"}=e,m=(0,r.A)(e,g);const x=(0,n.oU)(a,"card-header"),f=(0,c.useMemo)(()=>({cardHeaderBsPrefix:x}),[x]);return(0,d.jsx)(u.Provider,{value:f,children:(0,d.jsx)(o,(0,t.A)((0,t.A)({ref:s},m),{},{className:i()(l,x)}))})});p.displayName="CardHeader";const v=p,j=["bsPrefix","className","variant","as"],A=c.forwardRef((e,s)=>{let{bsPrefix:a,className:l,variant:c,as:o="img"}=e,m=(0,r.A)(e,j);const x=(0,n.oU)(a,"card-img");return(0,d.jsx)(o,(0,t.A)({ref:s,className:i()(c?"".concat(x,"-").concat(c):x,l)},m))});A.displayName="CardImg";const y=A,w=["className","bsPrefix","as"],P=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c="div"}=e,o=(0,r.A)(e,w);return l=(0,n.oU)(l,"card-img-overlay"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});P.displayName="CardImgOverlay";const C=P,U=["className","bsPrefix","as"],k=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c="a"}=e,o=(0,r.A)(e,U);return l=(0,n.oU)(l,"card-link"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});k.displayName="CardLink";const S=k;var R=a(4488);const _=["className","bsPrefix","as"],T=(0,R.A)("h6"),E=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c=T}=e,o=(0,r.A)(e,_);return l=(0,n.oU)(l,"card-subtitle"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});E.displayName="CardSubtitle";const I=E,D=["className","bsPrefix","as"],F=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c="p"}=e,o=(0,r.A)(e,D);return l=(0,n.oU)(l,"card-text"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});F.displayName="CardText";const L=F,B=["className","bsPrefix","as"],G=(0,R.A)("h5"),O=c.forwardRef((e,s)=>{let{className:a,bsPrefix:l,as:c=G}=e,o=(0,r.A)(e,B);return l=(0,n.oU)(l,"card-title"),(0,d.jsx)(c,(0,t.A)({ref:s,className:i()(a,l)},o))});O.displayName="CardTitle";const M=O,z=["bsPrefix","className","bg","text","border","body","children","as"],H=c.forwardRef((e,s)=>{let{bsPrefix:a,className:l,bg:c,text:o,border:m,body:f=!1,children:h,as:b="div"}=e,N=(0,r.A)(e,z);const u=(0,n.oU)(a,"card");return(0,d.jsx)(b,(0,t.A)((0,t.A)({ref:s},N),{},{className:i()(l,u,c&&"bg-".concat(c),o&&"text-".concat(o),m&&"border-".concat(m)),children:f?(0,d.jsx)(x,{children:h}):h}))});H.displayName="Card";const q=Object.assign(H,{Img:y,Title:M,Subtitle:I,Body:x,Link:S,Text:L,Header:v,Footer:b,ImgOverlay:C})},9665:(e,s,a)=>{a.r(s),a.d(s,{default:()=>v});var t=a(2555),r=a(5043),l=a(8163),i=a(4063),c=a(4282),n=a(8258),d=a(8602),o=a(3519),m=a(6522),x=a(1072),f=a(7417),h=a(196),b=a(6667),N=a(5016),u=a(3829),g=a(579);const p=e=>{let{title:s}=e;return(0,g.jsx)("div",{className:"d-flex align-items-center justify-content-center p-4",style:{background:(0,u.Sk)(s),color:"white",height:"200px",textAlign:"center",fontSize:"1.75rem",fontWeight:"800",textShadow:"0 2px 4px rgba(0,0,0,0.1)",letterSpacing:"-0.02em"},children:s})};const v=function(){var e;const[s,a]=(0,r.useState)([]),[v,j]=(0,r.useState)(!0),[A,y]=(0,r.useState)("date"),{userProfile:w,logout:P}=(0,N.A)(),C=(0,l.Zp)();(0,r.useEffect)(()=>{(async()=>{if(w)try{const e=(0,b.rJ)(h.db,"events");let s;s="admin"===w.role?(0,b.P)(e,(0,b.My)("createdAt","desc")):(0,b.P)(e,(0,b._M)("promoters","array-contains",w.uid));let r=(await(0,b.GG)(s)).docs.map(e=>(0,t.A)({id:e.id},e.data()));const l=await Promise.all(r.map(async e=>{const s=(0,b.rJ)(h.db,"events",e.id,"reservations"),a=await(0,b.GG)(s);return(0,t.A)((0,t.A)({},e),{},{reservationCount:a.size})}));a(l)}catch(e){console.error("Error fetching events: ",e)}finally{j(!1)}})()},[w]);const U=[...s].sort((e,s)=>{switch(A){case"name":return e.title.localeCompare(s.title);case"reservations":return(s.reservationCount||0)-(e.reservationCount||0);default:return s.createdAt-e.createdAt}}),k=U.filter(e=>"disabled"!==e.status),S=U.filter(e=>"disabled"===e.status);return(0,g.jsxs)(o.A,{className:"page-container fade-in",children:[(0,g.jsxs)("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-5 gap-3",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h1",{className:"display-5 mb-1 fw-bold text-gradient",children:"Dashboard"}),(0,g.jsxs)("p",{className:"text-muted mb-0 fs-5",children:["Welcome back, ",(0,g.jsx)("span",{className:"fw-semibold text-dark",children:null===w||void 0===w?void 0:w.username}),(0,g.jsx)(i.A,{bg:"light",text:"dark",className:"ms-2 border",children:null===w||void 0===w||null===(e=w.role)||void 0===e?void 0:e.toUpperCase()})]})]}),(0,g.jsxs)("div",{className:"d-flex gap-2 align-items-center flex-wrap",children:[(0,g.jsxs)(m.A.Select,{value:A,onChange:e=>y(e.target.value),style:{width:"auto",minWidth:"160px"},className:"shadow-sm",children:[(0,g.jsx)("option",{value:"date",children:"Sort by Date"}),(0,g.jsx)("option",{value:"name",children:"Sort by Name"}),(0,g.jsx)("option",{value:"reservations",children:"Sort by Reservations"})]}),"admin"===(null===w||void 0===w?void 0:w.role)&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(c.A,{as:l.N_,to:"/users",variant:"outline-secondary",className:"d-flex align-items-center",children:[(0,g.jsx)("i",{className:"bi bi-people me-2"})," Users"]}),(0,g.jsxs)(c.A,{as:l.N_,to:"/create",variant:"primary",className:"d-flex align-items-center shadow-sm",children:[(0,g.jsx)("i",{className:"bi bi-plus-lg me-2"})," New Event"]})]}),(0,g.jsx)("div",{className:"vr mx-2 d-none d-md-block"}),(0,g.jsx)(c.A,{as:l.N_,to:"/settings",variant:"light",className:"btn-icon rounded-circle border",title:"Settings",children:(0,g.jsx)("i",{className:"bi bi-gear-fill text-muted"})}),(0,g.jsx)(c.A,{variant:"light",className:"btn-icon rounded-circle border",onClick:async()=>{try{await P(),C("/login")}catch(e){console.error("Failed to log out",e)}},title:"Log Out",children:(0,g.jsx)("i",{className:"bi bi-box-arrow-right text-danger"})})]})]}),v?(0,g.jsxs)("div",{className:"text-center py-5",children:[(0,g.jsx)(f.A,{animation:"border",variant:"primary",role:"status",style:{width:"3rem",height:"3rem"},children:(0,g.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,g.jsx)("p",{className:"text-muted mt-3",children:"Loading your events..."})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(x.A,{className:"mb-4 g-3",children:[(0,g.jsx)(d.A,{xs:6,md:3,children:(0,g.jsxs)(n.A,{className:"glass-card border-0 h-100 p-3 text-center",children:[(0,g.jsx)("h3",{className:"fw-bold text-primary mb-0",children:k.length}),(0,g.jsx)("small",{className:"text-muted fw-bold",children:"Active Events"})]})}),(0,g.jsx)(d.A,{xs:6,md:3,children:(0,g.jsxs)(n.A,{className:"glass-card border-0 h-100 p-3 text-center",children:[(0,g.jsx)("h3",{className:"fw-bold text-success mb-0",children:k.reduce((e,s)=>e+(s.reservationCount||0),0)}),(0,g.jsx)("small",{className:"text-muted fw-bold",children:"Total Reservations"})]})})]}),(0,g.jsx)("h4",{className:"mb-4 fw-bold text-dark border-bottom pb-2",children:"Active Events"}),0===k.length&&(0,g.jsxs)("div",{className:"text-center py-5 glass-card",children:[(0,g.jsx)("div",{className:"mb-3 text-muted",style:{fontSize:"3rem"},children:(0,g.jsx)("i",{className:"bi bi-calendar-x"})}),(0,g.jsx)("h4",{children:"No active events found"}),(0,g.jsx)("p",{className:"text-muted",children:"Get started by creating a new event."}),"admin"===(null===w||void 0===w?void 0:w.role)&&(0,g.jsx)(c.A,{as:l.N_,to:"/create",variant:"primary",className:"mt-2",children:"Create Event"})]}),(0,g.jsx)(x.A,{className:"g-4",children:k.map(e=>(0,g.jsx)(d.A,{md:6,lg:4,children:(0,g.jsxs)(n.A,{as:l.N_,to:"/event/".concat(e.id),className:"h-100 glass-card border-0 overflow-hidden text-decoration-none text-dark",children:[(0,g.jsxs)("div",{className:"position-relative",children:["placeholder"!==e.imageUrl&&e.imageUrl?(0,g.jsx)(n.A.Img,{variant:"top",src:e.imageUrl,style:{height:"200px",objectFit:"cover"}}):(0,g.jsx)(p,{title:e.title}),(0,g.jsx)("div",{className:"position-absolute top-0 end-0 p-3",children:(0,g.jsxs)(i.A,{bg:"white",text:"dark",className:"shadow-sm py-2 px-3 rounded-pill",children:[(0,g.jsx)("i",{className:"bi bi-people-fill me-1 text-primary"}),e.reservationCount||0]})})]}),(0,g.jsxs)(n.A.Body,{className:"p-4",children:[(0,g.jsx)(n.A.Title,{className:"fw-bold mb-1 fs-5",children:e.title}),(0,g.jsxs)(n.A.Text,{className:"text-muted small mb-3",children:[(0,g.jsx)("i",{className:"bi bi-calendar-event me-2"}),(0,u.Yq)(e.time)]}),(0,g.jsx)("div",{className:"d-flex justify-content-between align-items-center mt-3",children:(0,g.jsx)("span",{className:"text-primary fw-semibold small",children:"Manage Event \u2192"})})]})]})},e.id))}),S.length>0&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"d-flex align-items-center my-5",children:[(0,g.jsx)("hr",{className:"flex-grow-1"}),(0,g.jsx)("span",{className:"mx-3 text-muted fw-bold small text-uppercase",children:"Past Events"}),(0,g.jsx)("hr",{className:"flex-grow-1"})]}),(0,g.jsx)(x.A,{className:"g-4 opacity-75",children:S.map(e=>(0,g.jsx)(d.A,{md:6,lg:4,children:(0,g.jsxs)(n.A,{as:l.N_,to:"/event/".concat(e.id),className:"text-decoration-none text-muted h-100 glass-card border-0 grayscale-hover",children:[(0,g.jsx)("div",{style:{filter:"grayscale(100%)"},children:"placeholder"!==e.imageUrl&&e.imageUrl?(0,g.jsx)(n.A.Img,{variant:"top",src:e.imageUrl,style:{height:"160px",objectFit:"cover"}}):(0,g.jsx)(p,{title:e.title})}),(0,g.jsxs)(n.A.Body,{className:"p-3",children:[(0,g.jsxs)(n.A.Title,{className:"fs-6",children:[e.title," (Disabled)"]}),(0,g.jsx)(n.A.Text,{className:"small",children:(0,u.Yq)(e.time)})]})]})},e.id))})]})]})]})}}}]);
//# sourceMappingURL=665.85a07b9d.chunk.js.map