{"version":3,"file":"static/js/483.371e1e8b.chunk.js","mappings":"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","sources":["components/AccountSettings.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Container, Card, Form, Button, Alert, Modal } from 'react-bootstrap';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { updatePassword, deleteUser, reauthenticateWithCredential, EmailAuthProvider } from 'firebase/auth';\nimport { doc, deleteDoc } from 'firebase/firestore';\nimport { db, auth } from '../firebase';\n\nexport default function AccountSettings() {\n    const { currentUser, logout } = useAuth();\n    const navigate = useNavigate();\n    const [password, setPassword] = useState('');\n    const [confirmPassword, setConfirmPassword] = useState('');\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [message, setMessage] = useState('');\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\n\n    // For re-auth (if needed, though we might skip complex re-auth UI for this MVP unless it errors)\n    // Firebase throws 'auth/requires-recent-login' if the user hasn't logged in recently.\n\n    const handlePasswordChange = async (e) => {\n        e.preventDefault();\n        if (password !== confirmPassword) {\n            return setError('Passwords do not match');\n        }\n\n        try {\n            setError('');\n            setMessage('');\n            setLoading(true);\n            await updatePassword(currentUser, password);\n            setMessage('Password updated successfully');\n            setPassword('');\n            setConfirmPassword('');\n        } catch (err) {\n            if (err.code === 'auth/requires-recent-login') {\n                setError('For security, please log out and log back in to change your password.');\n            } else {\n                setError('Failed to update password: ' + err.message);\n            }\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleDeleteAccount = async () => {\n        try {\n            setError('');\n            setLoading(true);\n\n            // 1. Delete user data from Firestore\n            await deleteDoc(doc(db, 'users', currentUser.uid));\n\n            // 2. Delete user from Firebase Auth\n            await deleteUser(currentUser);\n\n            // Redirect is handled by AuthContext or App state change usually, but let's force it\n            navigate('/login');\n        } catch (err) {\n            if (err.code === 'auth/requires-recent-login') {\n                setError('For security, please log out and log back in to delete your account.');\n                setShowDeleteModal(false);\n            } else {\n                setError('Failed to delete account: ' + err.message);\n                setShowDeleteModal(false);\n            }\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Container className=\"my-4\" style={{ maxWidth: '600px' }}>\n            <h2 className=\"mb-4\">Account Settings</h2>\n            {error && <Alert variant=\"danger\">{error}</Alert>}\n            {message && <Alert variant=\"success\">{message}</Alert>}\n\n            <Card className=\"glass-card border-0 mb-4\">\n                <Card.Body>\n                    <h4 className=\"mb-3\">Change Password</h4>\n                    <Form onSubmit={handlePasswordChange}>\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>New Password</Form.Label>\n                            <Form.Control\n                                type=\"password\"\n                                value={password}\n                                onChange={(e) => setPassword(e.target.value)}\n                                required\n                                minLength={6}\n                            />\n                        </Form.Group>\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>Confirm New Password</Form.Label>\n                            <Form.Control\n                                type=\"password\"\n                                value={confirmPassword}\n                                onChange={(e) => setConfirmPassword(e.target.value)}\n                                required\n                                minLength={6}\n                            />\n                        </Form.Group>\n                        <Button disabled={loading} type=\"submit\" variant=\"primary\">\n                            Update Password\n                        </Button>\n                    </Form>\n                </Card.Body>\n            </Card>\n\n            <Card className=\"glass-card border-0 border-danger\">\n                <Card.Body>\n                    <h4 className=\"text-danger mb-3\">Danger Zone</h4>\n                    <p>Once you delete your account, there is no going back. Please be certain.</p>\n                    <Button variant=\"danger\" onClick={() => setShowDeleteModal(true)} disabled={loading}>\n                        Delete Account\n                    </Button>\n                </Card.Body>\n            </Card>\n\n            {/* Delete Confirmation Modal */}\n            <Modal show={showDeleteModal} onHide={() => setShowDeleteModal(false)}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Delete Account</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    Are you sure you want to delete your account? This action cannot be undone.\n                </Modal.Body>\n                <Modal.Footer>\n                    <Button variant=\"secondary\" onClick={() => setShowDeleteModal(false)}>\n                        Cancel\n                    </Button>\n                    <Button variant=\"danger\" onClick={handleDeleteAccount} disabled={loading}>\n                        {loading ? 'Deleting...' : 'Delete Forever'}\n                    </Button>\n                </Modal.Footer>\n            </Modal>\n        </Container>\n    );\n}\n"],"names":["AccountSettings","currentUser","logout","useAuth","navigate","useNavigate","password","setPassword","useState","confirmPassword","setConfirmPassword","loading","setLoading","error","setError","message","setMessage","showDeleteModal","setShowDeleteModal","_jsxs","Container","className","style","maxWidth","children","_jsx","Alert","variant","Card","Body","Form","onSubmit","async","e","preventDefault","updatePassword","err","code","Group","Label","Control","type","value","onChange","target","required","minLength","Button","disabled","onClick","Modal","show","onHide","Header","closeButton","Title","Footer","deleteDoc","doc","db","uid","deleteUser"],"ignoreList":[],"sourceRoot":""}