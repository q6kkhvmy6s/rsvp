"use strict";(self.webpackChunkreservaciones_admin=self.webpackChunkreservaciones_admin||[]).push([[905],{3829:(e,a,s)=>{s.d(a,{GF:()=>l,Sk:()=>t,Yq:()=>r});const r=e=>{if(!e)return"";let a;return a=e&&"object"===typeof e&&"seconds"in e?new Date(1e3*e.seconds):new Date(e),isNaN(a.getTime())?"Invalid Date":a.toLocaleString("default",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},t=e=>{const a=["linear-gradient(135deg, #f6d365 0%, #fda085 100%)","linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%)","linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)","linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%)"];let s=0;for(let r=0;r<e.length;r++)s=e.charCodeAt(r)+((s<<5)-s);return a[Math.abs(s)%a.length]},l=(e,a,s)=>{if(!e||0===e.length)return void alert("No reservations to export");const t=a.fields.map(e=>e.label);t.push("Promoter","Created At");const l=e.map(e=>{const t=a.fields.map(a=>{const s=e.formData[a.label]||"";return'"'.concat(String(s).replace(/"/g,'""'),'"')}),l=s[e.promoterId]||(e.promoterId?"Unknown":"Direct");t.push('"'.concat(l,'"'));const n=r(e.createdAt);return t.push('"'.concat(n,'"')),t.join(",")}),n=[t.join(","),...l].join("\n"),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),d=URL.createObjectURL(i);c.setAttribute("href",d),c.setAttribute("download","".concat(a.title.replace(/[^a-z0-9]/gi,"_"),"_reservations_").concat((new Date).toISOString().split("T")[0],".csv")),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}},3905:(e,a,s)=>{s.r(a),s.d(a,{default:()=>h});var r=s(2555),t=s(5043),l=s(8163),n=s(6509),i=s(4282),c=s(8258),d=s(3519),o=s(6522),m=s(7417),f=s(196),x=s(6667),u=s(3829),b=s(579);const h=function(){const{id:e}=(0,l.g)(),[a]=(0,l.ok)(),s=a.get("ref"),h=a.get("field_id"),p=a.get("val");let N=a.get("field_value");if(p)try{N=decodeURIComponent(escape(atob(p)))}catch(D){console.error("Failed to decode value",D)}const[v,g]=(0,t.useState)(null),[j,A]=(0,t.useState)(!0),[y,w]=(0,t.useState)(!1),[C,P]=(0,t.useState)(null),[S,R]=(0,t.useState)(!1),[U,k]=(0,t.useState)({});(0,t.useEffect)(()=>((async()=>{try{const a=(0,x.H9)(f.db,"events",e),s=await(0,x.x7)(a);if(s.exists()){const e=s.data();if("disabled"===e.status)P("Este evento ya no acepta reservaciones.");else if(!1===e.acceptingReservations)P("Las reservaciones para este evento est\xe1n pausadas actualmente. Por favor, vuelve a intentarlo m\xe1s tarde.");else{g((0,r.A)({id:s.id},e)),document.title=e.title;const a={};if(e.fields.forEach(e=>{e.isInternal||(a[e.label]="")}),h&&N){const s=e.fields.find(e=>String(e.id)===h);s&&(a[s.label]=N)}k(a)}}else P("Evento no encontrado.")}catch(a){console.error(a),P("Error al cargar los detalles del evento.")}finally{A(!1)}})(),()=>{document.title="Reservaciones"}),[e,h,N]);const I=(e,a)=>{k(s=>(0,r.A)((0,r.A)({},s),{},{[e]:a}))};if(j)return(0,b.jsx)(d.A,{className:"text-center my-5",children:(0,b.jsx)(m.A,{animation:"border"})});if(C)return(0,b.jsx)(d.A,{className:"my-5",children:(0,b.jsx)(n.A,{variant:"danger",children:C})});if(S)return(0,b.jsx)(d.A,{className:"my-5",children:(0,b.jsx)(c.A,{className:"text-center p-5 shadow-sm",children:(0,b.jsxs)(c.A.Body,{children:[(0,b.jsx)("h2",{className:"text-success mb-4",children:"\xa1Reservaci\xf3n Confirmada!"}),(0,b.jsxs)("p",{className:"lead",children:["Gracias por reservar tu lugar en ",(0,b.jsx)("strong",{children:v.title}),"."]}),(0,b.jsx)("hr",{}),(0,b.jsxs)("div",{className:"text-start d-inline-block",children:[(0,b.jsx)("h5",{className:"mb-3",children:"Tus Detalles:"}),v.fields.filter(e=>!e.isInternal).map(e=>(0,b.jsxs)("p",{children:[(0,b.jsxs)("strong",{children:[e.label,":"]})," ",U[e.label]]},e.id))]})]})})});const T=v.fields.filter(e=>!e.isInternal);return(0,b.jsx)(d.A,{className:"my-5",style:{maxWidth:"600px"},children:(0,b.jsxs)(c.A,{className:"shadow-sm glass-card border-0",children:[v.imageUrl&&"placeholder"!==v.imageUrl&&(0,b.jsx)(c.A.Img,{variant:"top",src:v.imageUrl,style:{width:"100%",height:"auto",maxHeight:"400px",objectFit:"contain",display:"block"}}),(0,b.jsxs)(c.A.Body,{className:"p-4",children:[(0,b.jsx)(c.A.Title,{as:"h2",className:"mb-3",children:v.title}),(0,b.jsxs)(c.A.Text,{className:"text-muted mb-4",children:[(0,b.jsx)("i",{className:"bi bi-calendar-event me-2"}),(0,u.Yq)(v.time),(0,b.jsx)("br",{}),(0,b.jsx)("i",{className:"bi bi-geo-alt me-2"}),v.place," - ",v.address]}),(0,b.jsx)(c.A.Text,{children:v.description}),v.note&&(0,b.jsx)(n.A,{variant:"info",className:"mt-3",children:v.note}),(0,b.jsx)("hr",{className:"my-4"}),(0,b.jsxs)(o.A,{onSubmit:async a=>{a.preventDefault(),w(!0);try{await(0,x.gS)((0,x.rJ)(f.db,"events",e,"reservations"),{formData:U,promoterId:s||null,createdAt:(0,x.O5)()}),R(!0)}catch(r){console.error(r),alert("Error al enviar la reservaci\xf3n. Por favor, int\xe9ntalo de nuevo.")}finally{w(!1)}},children:[T.map(e=>(0,b.jsxs)(o.A.Group,{className:"mb-3",children:[(0,b.jsxs)(o.A.Label,{children:[e.label," ",e.required&&(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),"select"===e.type?(0,b.jsxs)(o.A.Select,{required:e.required,value:U[e.label]||"",onChange:a=>I(e.label,a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Selecciona una opci\xf3n..."}),e.options.map((e,a)=>(0,b.jsx)("option",{value:e,children:e},a))]}):(0,b.jsx)(o.A.Control,{type:e.type,required:e.required,value:U[e.label]||"",onChange:a=>I(e.label,a.target.value),disabled:String(e.id)===h})]},e.id)),(0,b.jsx)(i.A,{variant:"primary",type:"submit",className:"w-100 mt-3",disabled:y,children:y?(0,b.jsx)(m.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Confirmar Reservaci\xf3n"})]})]})]})})}},8258:(e,a,s)=>{s.d(a,{A:()=>M});var r=s(2555),t=s(45),l=s(8139),n=s.n(l),i=s(5043),c=s(7852),d=s(579);const o=["className","bsPrefix","as"],m=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i="div"}=e,m=(0,t.A)(e,o);return l=(0,c.oU)(l,"card-body"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},m))});m.displayName="CardBody";const f=m,x=["className","bsPrefix","as"],u=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i="div"}=e,o=(0,t.A)(e,x);return l=(0,c.oU)(l,"card-footer"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});u.displayName="CardFooter";const b=u,h=i.createContext(null);h.displayName="CardHeaderContext";const p=h,N=["bsPrefix","className","as"],v=i.forwardRef((e,a)=>{let{bsPrefix:s,className:l,as:o="div"}=e,m=(0,t.A)(e,N);const f=(0,c.oU)(s,"card-header"),x=(0,i.useMemo)(()=>({cardHeaderBsPrefix:f}),[f]);return(0,d.jsx)(p.Provider,{value:x,children:(0,d.jsx)(o,(0,r.A)((0,r.A)({ref:a},m),{},{className:n()(l,f)}))})});v.displayName="CardHeader";const g=v,j=["bsPrefix","className","variant","as"],A=i.forwardRef((e,a)=>{let{bsPrefix:s,className:l,variant:i,as:o="img"}=e,m=(0,t.A)(e,j);const f=(0,c.oU)(s,"card-img");return(0,d.jsx)(o,(0,r.A)({ref:a,className:n()(i?"".concat(f,"-").concat(i):f,l)},m))});A.displayName="CardImg";const y=A,w=["className","bsPrefix","as"],C=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i="div"}=e,o=(0,t.A)(e,w);return l=(0,c.oU)(l,"card-img-overlay"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});C.displayName="CardImgOverlay";const P=C,S=["className","bsPrefix","as"],R=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i="a"}=e,o=(0,t.A)(e,S);return l=(0,c.oU)(l,"card-link"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});R.displayName="CardLink";const U=R;var k=s(4488);const I=["className","bsPrefix","as"],T=(0,k.A)("h6"),D=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i=T}=e,o=(0,t.A)(e,I);return l=(0,c.oU)(l,"card-subtitle"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});D.displayName="CardSubtitle";const q=D,E=["className","bsPrefix","as"],L=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i="p"}=e,o=(0,t.A)(e,E);return l=(0,c.oU)(l,"card-text"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});L.displayName="CardText";const _=L,B=["className","bsPrefix","as"],H=(0,k.A)("h5"),O=i.forwardRef((e,a)=>{let{className:s,bsPrefix:l,as:i=H}=e,o=(0,t.A)(e,B);return l=(0,c.oU)(l,"card-title"),(0,d.jsx)(i,(0,r.A)({ref:a,className:n()(s,l)},o))});O.displayName="CardTitle";const F=O,G=["bsPrefix","className","bg","text","border","body","children","as"],z=i.forwardRef((e,a)=>{let{bsPrefix:s,className:l,bg:i,text:o,border:m,body:x=!1,children:u,as:b="div"}=e,h=(0,t.A)(e,G);const p=(0,c.oU)(s,"card");return(0,d.jsx)(b,(0,r.A)((0,r.A)({ref:a},h),{},{className:n()(l,p,i&&"bg-".concat(i),o&&"text-".concat(o),m&&"border-".concat(m)),children:x?(0,d.jsx)(f,{children:u}):u}))});z.displayName="Card";const M=Object.assign(z,{Img:y,Title:F,Subtitle:q,Body:f,Link:U,Text:_,Header:g,Footer:b,ImgOverlay:P})}}]);
//# sourceMappingURL=905.6ce4c7ff.chunk.js.map