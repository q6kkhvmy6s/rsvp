"use strict";(self.webpackChunkreservaciones_admin=self.webpackChunkreservaciones_admin||[]).push([[161],{1072:(e,s,a)=>{a.d(s,{A:()=>x});var l=a(2555),i=a(45),n=a(8139),t=a.n(n),r=a(5043),c=a(7852),d=a(579);const o=["bsPrefix","className","as"],m=r.forwardRef((e,s)=>{let{bsPrefix:a,className:n,as:r="div"}=e,m=(0,i.A)(e,o);const x=(0,c.oU)(a,"row"),h=(0,c.gy)(),b=(0,c.Jm)(),j="".concat(x,"-cols"),p=[];return h.forEach(e=>{const s=m[e];let a;delete m[e],null!=s&&"object"===typeof s?({cols:a}=s):a=s;const l=e!==b?"-".concat(e):"";null!=a&&p.push("".concat(j).concat(l,"-").concat(a))}),(0,d.jsx)(r,(0,l.A)((0,l.A)({ref:s},m),{},{className:t()(n,x,...p)}))});m.displayName="Row";const x=m},1161:(e,s,a)=>{a.r(s),a.d(s,{default:()=>A});var l=a(2555),i=a(5043),n=a(6509),t=a(4282),r=a(8602),c=a(3519),d=a(6522),o=a(1666),m=a(1072),x=a(7417),h=a(196),b=a(6667),j=a(6068),p=a(8163),u=a(579);const A=function(){const{id:e}=(0,p.g)(),s=(0,p.Zp)(),[a,A]=(0,i.useState)(""),[N,v]=(0,i.useState)(""),[f,g]=(0,i.useState)(""),[y,C]=(0,i.useState)(""),[k,w]=(0,i.useState)(""),[F,S]=(0,i.useState)(""),[G,D]=(0,i.useState)(null),[E,I]=(0,i.useState)(""),[L,P]=(0,i.useState)(!0),[z,R]=(0,i.useState)(!1),[T,U]=(0,i.useState)(null),[O,q]=(0,i.useState)(null),[_,V]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{try{const s=(0,b.H9)(h.db,"events",e),a=await(0,b.x7)(s);if(a.exists()){const e=a.data();A(e.title||""),v(e.description||""),g(e.time||""),C(e.place||""),w(e.address||""),S(e.note||""),I(e.imageUrl||""),V(e.fields||[]),q(e.primaryField||null)}else U("Event not found.")}catch(s){console.error(s),U("Failed to load event.")}finally{P(!1)}})()},[e]);const H=e=>{const s={id:Date.now(),label:"",type:e,required:!1,options:"select"===e?[""]:void 0};V([..._,s])},M=(e,s)=>{const{name:a,value:i}=s.target,n=_.map(s=>s.id===e?(0,l.A)((0,l.A)({},s),{},{[a]:i}):s);V(n)};return L?(0,u.jsx)(c.A,{className:"text-center my-5",children:(0,u.jsx)(x.A,{animation:"border"})}):T?(0,u.jsx)(c.A,{className:"my-5",children:(0,u.jsx)(n.A,{variant:"danger",children:T})}):(0,u.jsxs)(c.A,{className:"page-container fade-in",children:[(0,u.jsxs)("div",{className:"mb-5",children:[(0,u.jsx)("h1",{className:"display-5 fw-bold text-gradient mb-2",children:"Edit Event"}),(0,u.jsx)("p",{className:"text-muted fs-6",children:"Update your event details and reservation form"})]}),(0,u.jsxs)(d.A,{onSubmit:async l=>{l.preventDefault(),R(!0);try{let l=E;if(G)try{const e=(0,j.KR)(h.IG,"events/".concat(Date.now(),"_").concat(G.name)),s=await(0,j.D)(e,G);l=await(0,j.qk)(s.ref)}catch(i){console.error("Image upload failed:",i),alert("Failed to upload image. Event will be updated without changing the image.")}const n=e=>{if(Array.isArray(e))return e.map(e=>n(e));if(null!==e&&"object"===typeof e){const s={};return Object.keys(e).forEach(a=>{void 0!==e[a]&&(s[a]=n(e[a]))}),s}return e},t=n({title:a,description:N,time:f,place:y,address:k,note:F,imageUrl:l||"placeholder",fields:_,primaryField:O});await(0,b.mZ)((0,b.H9)(h.db,"events",e),t),R(!1),s("/event/".concat(e))}catch(T){console.error("Error updating event: ",T),R(!1),alert("Failed to update event. Please try again.")}},children:[(0,u.jsxs)("div",{className:"card-section",children:[(0,u.jsxs)("div",{className:"section-header",children:[(0,u.jsx)("div",{className:"icon",children:(0,u.jsx)("i",{className:"bi bi-calendar-event"})}),(0,u.jsx)("h3",{children:"Event Details"})]}),(0,u.jsx)(m.A,{children:(0,u.jsx)(r.A,{md:12,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-type"}),(0,u.jsx)("span",{children:"Event Title"})]}),(0,u.jsx)(d.A.Control,{type:"text",value:a,onChange:e=>A(e.target.value),required:!0,disabled:z,placeholder:"Enter event name"})]})})}),(0,u.jsx)(m.A,{children:(0,u.jsx)(r.A,{md:12,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-text-paragraph"}),(0,u.jsx)("span",{children:"Description"})]}),(0,u.jsx)(d.A.Control,{as:"textarea",rows:3,value:N,onChange:e=>v(e.target.value),disabled:z,placeholder:"Describe your event..."})]})})}),(0,u.jsxs)(m.A,{children:[(0,u.jsx)(r.A,{md:6,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-clock"}),(0,u.jsx)("span",{children:"Date & Time"})]}),(0,u.jsx)(d.A.Control,{type:"datetime-local",value:f,onChange:e=>g(e.target.value),disabled:z})]})}),(0,u.jsx)(r.A,{md:6,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-geo-alt"}),(0,u.jsx)("span",{children:"Venue Name"})]}),(0,u.jsx)(d.A.Control,{type:"text",value:y,onChange:e=>C(e.target.value),disabled:z,placeholder:"e.g., Grand Ballroom"})]})})]}),(0,u.jsx)(m.A,{children:(0,u.jsx)(r.A,{md:12,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-pin-map"}),(0,u.jsx)("span",{children:"Address"})]}),(0,u.jsx)(d.A.Control,{type:"text",value:k,onChange:e=>w(e.target.value),disabled:z,placeholder:"Full address"})]})})}),(0,u.jsx)(m.A,{children:(0,u.jsx)(r.A,{md:12,children:(0,u.jsxs)(d.A.Group,{className:"mb-3",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-sticky"}),(0,u.jsx)("span",{children:"Internal Note"})]}),(0,u.jsx)(d.A.Control,{as:"textarea",rows:2,value:F,onChange:e=>S(e.target.value),disabled:z,placeholder:"Private notes for admins and promoters"})]})})}),(0,u.jsx)(m.A,{children:(0,u.jsx)(r.A,{md:12,children:(0,u.jsxs)(d.A.Group,{className:"mb-0",children:[(0,u.jsxs)(d.A.Label,{className:"form-label-icon",children:[(0,u.jsx)("i",{className:"bi bi-image"}),(0,u.jsx)("span",{children:"Cover Image"})]}),E&&"placeholder"!==E&&(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsx)("small",{className:"text-muted d-block",children:"Current image:"}),(0,u.jsx)("img",{src:E,alt:"Current event",style:{maxWidth:"200px",height:"auto"},className:"rounded"})]}),(0,u.jsx)(d.A.Control,{type:"file",onChange:e=>{e.target.files[0]&&D(e.target.files[0])},disabled:z,accept:"image/*"}),(0,u.jsx)(d.A.Text,{className:"text-muted",children:"Upload a new image to replace the current one. Recommended size: 1200x600px"})]})})})]}),(0,u.jsxs)("div",{className:"card-section",children:[(0,u.jsxs)("div",{className:"section-header",children:[(0,u.jsx)("div",{className:"icon",children:(0,u.jsx)("i",{className:"bi bi-ui-checks"})}),(0,u.jsx)("h3",{children:"Reservation Form Fields"})]}),(0,u.jsx)("div",{className:"info-box mb-4",children:(0,u.jsxs)("p",{children:[(0,u.jsx)("i",{className:"bi bi-info-circle me-2"}),'Customize the information you want to collect from attendees. Mark fields as "Internal" to hide them from public forms.']})}),_.map(e=>(0,u.jsxs)("div",{className:"form-field-card",children:[(0,u.jsxs)(m.A,{className:"align-items-end g-3",children:[(0,u.jsx)(r.A,{md:4,children:(0,u.jsxs)(d.A.Group,{children:[(0,u.jsx)(d.A.Label,{className:"small fw-bold text-muted",children:"Field Label"}),(0,u.jsx)(d.A.Control,{type:"text",name:"label",value:e.label,onChange:s=>M(e.id,s),placeholder:"e.g., Email Address",disabled:z})]})}),(0,u.jsx)(r.A,{md:3,children:(0,u.jsxs)(d.A.Group,{children:[(0,u.jsx)(d.A.Label,{className:"small fw-bold text-muted",children:"Field Type"}),(0,u.jsxs)(d.A.Control,{as:"select",name:"type",value:e.type,disabled:!0,children:[(0,u.jsx)("option",{value:"text",children:"Text"}),(0,u.jsx)("option",{value:"number",children:"Number"}),(0,u.jsx)("option",{value:"date",children:"Date"}),(0,u.jsx)("option",{value:"select",children:"Dropdown"})]})]})}),(0,u.jsx)(r.A,{md:"auto",children:(0,u.jsx)(d.A.Check,{type:"radio",name:"primaryField",label:(0,u.jsxs)("span",{className:"small fw-bold",children:[(0,u.jsx)("i",{className:"bi bi-star-fill text-warning me-1"}),"Primary"]}),checked:O===e.id,onChange:()=>q(e.id)})}),(0,u.jsx)(r.A,{md:"auto",children:(0,u.jsx)(d.A.Check,{type:"checkbox",label:(0,u.jsxs)("span",{className:"small fw-bold",children:[(0,u.jsx)("i",{className:"bi bi-eye-slash me-1"}),"Internal"]}),checked:e.isInternal||!1,onChange:s=>M(e.id,{target:{name:"isInternal",value:s.target.checked}})})}),(0,u.jsx)(r.A,{md:"auto",className:"ms-auto",children:!e.required&&(0,u.jsx)(t.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{V(_.filter(s=>s.id!==e))})(e.id),disabled:z,children:(0,u.jsx)("i",{className:"bi bi-trash"})})})]}),"select"===e.type&&(0,u.jsxs)("div",{className:"options-container",children:[(0,u.jsxs)("h6",{children:[(0,u.jsx)("i",{className:"bi bi-list-ul me-2"}),"Dropdown Options"]}),e.options.map((s,a)=>(0,u.jsxs)(o.A,{className:"mb-2",size:"sm",children:[(0,u.jsx)(d.A.Control,{type:"text",value:s,onChange:s=>((e,s,a)=>{const i=_.map(i=>{if(i.id===e){const e=i.options.map((e,l)=>l===s?a.target.value:e);return(0,l.A)((0,l.A)({},i),{},{options:e})}return i});V(i)})(e.id,a,s),placeholder:"Option ".concat(a+1),disabled:z}),(0,u.jsx)(t.A,{variant:"outline-danger",onClick:()=>((e,s)=>{const a=_.map(a=>{if(a.id===e){const e=a.options.filter((e,a)=>a!==s);return(0,l.A)((0,l.A)({},a),{},{options:e})}return a});V(a)})(e.id,a),disabled:z,children:(0,u.jsx)("i",{className:"bi bi-x-lg"})})]},a)),(0,u.jsxs)(t.A,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{const s=_.map(s=>s.id===e?(0,l.A)((0,l.A)({},s),{},{options:[...s.options,""]}):s);V(s)})(e.id),disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-plus-lg me-1"}),"Add Option"]})]})]},e.id)),(0,u.jsxs)("div",{className:"d-flex gap-2 flex-wrap mt-3",children:[(0,u.jsxs)(t.A,{variant:"link",className:"btn-add-field",onClick:()=>H("text"),disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-plus-circle me-2"}),"Text Field"]}),(0,u.jsxs)(t.A,{variant:"link",className:"btn-add-field",onClick:()=>H("number"),disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-plus-circle me-2"}),"Number Field"]}),(0,u.jsxs)(t.A,{variant:"link",className:"btn-add-field",onClick:()=>H("date"),disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-plus-circle me-2"}),"Date Field"]}),(0,u.jsxs)(t.A,{variant:"link",className:"btn-add-field",onClick:()=>H("select"),disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-plus-circle me-2"}),"Dropdown Field"]})]})]}),(0,u.jsxs)("div",{className:"d-flex gap-2 justify-content-center",children:[(0,u.jsxs)(t.A,{as:p.N_,to:"/event/".concat(e),variant:"outline-secondary",className:"px-5",disabled:z,children:[(0,u.jsx)("i",{className:"bi bi-x-circle me-2"}),"Cancel"]}),(0,u.jsx)(t.A,{variant:"primary",type:"submit",className:"btn-submit-large px-5",disabled:z,children:z?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(x.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Saving Changes..."]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("i",{className:"bi bi-check-circle me-2"}),"Save Changes"]})})]})]})]})}},1666:(e,s,a)=>{a.d(s,{A:()=>A});var l=a(45),i=a(2555),n=a(8139),t=a.n(n),r=a(5043),c=a(7852),d=a(1068);const o=r.createContext(null);o.displayName="InputGroupContext";const m=o;var x=a(579);const h=["className","bsPrefix","as"],b=r.forwardRef((e,s)=>{let{className:a,bsPrefix:n,as:r="span"}=e,d=(0,l.A)(e,h);return n=(0,c.oU)(n,"input-group-text"),(0,x.jsx)(r,(0,i.A)({ref:s,className:t()(a,n)},d))});b.displayName="InputGroupText";const j=b,p=["bsPrefix","size","hasValidation","className","as"],u=r.forwardRef((e,s)=>{let{bsPrefix:a,size:n,hasValidation:d,className:o,as:h="div"}=e,b=(0,l.A)(e,p);a=(0,c.oU)(a,"input-group");const j=(0,r.useMemo)(()=>({}),[]);return(0,x.jsx)(m.Provider,{value:j,children:(0,x.jsx)(h,(0,i.A)((0,i.A)({ref:s},b),{},{className:t()(o,a,n&&"".concat(a,"-").concat(n),d&&"has-validation")}))})});u.displayName="InputGroup";const A=Object.assign(u,{Text:j,Radio:e=>(0,x.jsx)(j,{children:(0,x.jsx)(d.A,(0,i.A)({type:"radio"},e))}),Checkbox:e=>(0,x.jsx)(j,{children:(0,x.jsx)(d.A,(0,i.A)({type:"checkbox"},e))})})}}]);
//# sourceMappingURL=161.0e7e603e.chunk.js.map